<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Dev • API Console Portfolio</title>
  <meta name="description" content="Interact with my portfolio by sending POST requests." />
  <style>
    :root{
      --bg:#0b0d10; --panel:#0f1318; --panel-2:#11161c; --text:#e7eef7; --muted:#9fb2c7; --accent:#6ea8fe; --ok:#58d38b; --bad:#ff7a7a; --border:#1b232c; --focus:#2a3542;
      --radius:16px; --radius-sm:12px; --shadow:0 6px 30px rgba(0,0,0,.35);
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, "Helvetica Neue", Arial, "Apple Color Emoji", "Segoe UI Emoji";
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;background:linear-gradient(180deg,#0b0d10 0%, #0b0d10 60%, #0d1117 100%);color:var(--text);font-family:var(--sans);}
    .wrap{max-width:980px;margin:0 auto;padding:32px}
    header{display:flex;align-items:center;justify-content:space-between;margin-bottom:20px}
    .brand{display:flex;gap:14px;align-items:center}
    .dot{width:10px;height:10px;border-radius:999px;background:var(--ok);box-shadow:0 0 16px var(--ok)}
    .title{font-weight:700;letter-spacing:.3px}
  /* Cards use flex column so their internal rows keep shape on resize */
  .card{display:flex;flex-direction:column;justify-content:flex-start;background:linear-gradient(180deg,var(--panel) 0%, var(--panel-2) 100%);border:1px solid var(--border);border-radius:var(--radius);box-shadow:var(--shadow);min-height:420px}
    .subtle{color:var(--muted)}
    .grid{display:grid;gap:16px;align-items:stretch}
    @media(min-width:900px){.grid{grid-template-columns:1.1fr .9fr}}
    /* Responsive adjustments for card min-height */
    @media(max-width:900px){
      .card{min-height:360px}
    }
    @media(max-width:600px){
      /* On narrow screens avoid forcing large height */
      .card{min-height:0}
    }

  .row{padding:18px;border-bottom:1px dashed var(--border);flex:0 0 auto}
  .row:last-child{border-bottom:0}
  /* Allow console area to flex inside the card without altering card shape */
  .card .console{flex:1 1 auto;min-height:0}
  /* Make history scroll if it grows too tall */
  .history{display:flex;gap:8px;flex-wrap:wrap;max-height:140px;overflow:auto;padding-right:6px}

    .label{font-size:.85rem;color:var(--muted);margin-bottom:8px}
    input, textarea, select{width:100%;background:#0b0f14;color:var(--text);border:1px solid var(--border);border-radius:var(--radius-sm);padding:12px 14px;font-family:var(--mono);font-size:.95rem;outline:none}
    input:focus, textarea:focus, select:focus{border-color:var(--accent);box-shadow:0 0 0 4px rgba(110,168,254,.08)}

    .toolbar{display:flex;gap:10px;align-items:center}
    .btn{appearance:none;border:1px solid var(--border);background:linear-gradient(180deg,#131922 0%,#0e131a 100%);color:var(--text);padding:10px 14px;border-radius:12px;font-weight:600;cursor:pointer;transition:.2s;box-shadow:0 3px 12px rgba(0,0,0,.25)}
    .btn:hover{transform:translateY(-1px);border-color:#273241}
    .btn.primary{border-color:#2b4a7a;background:linear-gradient(180deg,#1a3a64 0%,#142b47 100%)}
    .btn.ghost{background:transparent}
    .badge{padding:6px 10px;border:1px solid var(--border);border-radius:999px;font-family:var(--mono);font-size:.8rem;color:var(--muted)}

    .console{padding:16px;border-radius:var(--radius);background:#0b0f14;border:1px solid var(--border);min-height:180px;max-height:420px;overflow:auto;font-family:var(--mono);font-size:.95rem;line-height:1.5}
    .ok{color:var(--ok)}
    .bad{color:var(--bad)}

    .hint{display:flex;gap:8px;flex-wrap:wrap}
    .hint code{background:#0b0f14;border:1px solid var(--border);padding:6px 10px;border-radius:10px}

    .history{display:flex;gap:8px;flex-wrap:wrap}
    .pill{padding:8px 12px;border:1px solid var(--border);border-radius:999px;font-family:var(--mono);cursor:pointer}

    footer{margin-top:28px;color:var(--muted);font-size:.9rem;display:flex;justify-content:space-between;flex-wrap:wrap;gap:10px}
    a{color:var(--accent);text-decoration:none}
  .kbd{font-family:var(--mono);border:1px solid var(--border);padding:2px 6px;border-radius:6px;background:#0b0f14}
  /* Inline spinner for Send button */
  .btn-spinner{display:inline-block;width:16px;height:16px;border-radius:50%;border:2px solid rgba(255,255,255,0.08);border-top-color:var(--accent);animation:spin 1s linear infinite;margin-left:10px;vertical-align:middle}
  .btn-spinner.hidden{display:none}
  @keyframes spin{to{transform:rotate(360deg)}}
  /* Toast notifications */
  .toast{position:fixed;right:20px;bottom:20px;min-width:180px;max-width:320px;padding:10px 14px;border-radius:10px;background:linear-gradient(180deg,#0f1317,#0b1013);color:var(--text);box-shadow:0 8px 30px rgba(0,0,0,.45);transform:translateY(18px);opacity:0;pointer-events:none;transition:transform .25s cubic-bezier(.2,.9,.2,1),opacity .25s ease,box-shadow .2s}
  .toast.show{transform:translateY(0);opacity:1;pointer-events:auto}
  .toast.ok{border-left:4px solid var(--ok)}
  .toast.bad{border-left:4px solid var(--bad)}
  .toast .msg{font-family:var(--sans);font-size:.95rem}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <div class="dot" aria-hidden="true"></div>
        <div>
          <div class="title">Dev • API Console Portfolio</div>
          <div class="subtle">Send <strong>POST</strong> requests to discover me.</div>
        </div>
      </div>
      <div class="badge" id="status">idle</div>
    </header>

    <div class="grid">
      <!-- Left: Request builder -->
      <div class="card">
        <div class="row">
          <div class="label">Base URL (your API on Render)</div>
          <input id="baseUrl" placeholder="https://your-backend.onrender.com" />
        </div>
        <div class="row">
          <div class="label">Endpoint (only POST is accepted)</div>
          <div class="toolbar">
            <span class="badge">POST</span>
            <input id="endpoint" placeholder="/api/about/" />
            <button class="btn ghost" id="suggest">/ browse</button>
          </div>
          <div class="hint" style="margin-top:10px">
            <code class="cmd">/api/about/</code>
            <code class="cmd">/api/skills/</code>
            <code class="cmd">/api/projects/</code>
            <code class="cmd">/api/resume/</code>
            <code class="cmd">/api/random-fact/</code>
            <code class="cmd">/api/hireme/</code>
          </div>
        </div>
        <div class="row">
          <div class="label">Request body (JSON)</div>
          <textarea id="body" rows="8" placeholder='{"detail":"full"}'></textarea>
          <div class="toolbar" style="margin-top:10px">
            <button class="btn" id="send">Send (⏎) <span class="btn-spinner hidden" aria-hidden="true"></span></button>
            <button class="btn ghost" id="clear">Clear</button>
            <button class="btn ghost" id="copyCurl">Copy as cURL</button>
          </div>
        </div>
        <div class="row">
          <div class="label">History</div>
          <div class="history" id="history"></div>
        </div>
      </div>

      <!-- Right: Response viewer -->
      <div class="card">
        <div class="row">
          <div class="label">Response</div>
          <div class="console" id="console" aria-live="polite">Ready. Type an endpoint and press <span class="kbd">Enter</span>.</div>
        </div>
      </div>
    </div>

    <footer>
      <div>Tip: try <code>{"detail":"full"}</code> with <code>/api/about/</code>.</div>
      <div>Keyboard: <span class="kbd">Enter</span> send • <span class="kbd">Ctrl</span>+<span class="kbd">K</span> focus endpoint</div>
    </footer>
  </div>

  <!-- loader overlay removed in favor of inline spinner inside Send button -->
  <!-- Toast notification -->
  <div id="toast" class="toast" aria-hidden="true"><div class="msg" id="toastMsg"></div></div>

  <script>
    const qs = sel => document.querySelector(sel);
    const baseEl = qs('#baseUrl');
    const epEl = qs('#endpoint');
    const bodyEl = qs('#body');
    const sendBtn = qs('#send');
    const clearBtn = qs('#clear');
    const curlBtn = qs('#copyCurl');
    const out = qs('#console');
    const hist = qs('#history');
    const status = qs('#status');

  // Hardcoded Render base URL (as requested)
  const HARDCODED_BASE = 'https://api-portfolio-backend-zhrv.onrender.com';
  const EXAMPLE_CMDS = ["/api/about/","/api/skills/","/api/projects/","/api/resume/","/api/random-fact/","/api/hireme/"];

  // Persist base URL & last endpoint. Base is pre-filled with the Render URL and persisted.
  baseEl.value = localStorage.getItem('baseUrl') || HARDCODED_BASE;
  // ensure persistence and make it clear it's fixed in this UI
  localStorage.setItem('baseUrl', baseEl.value);
  try { baseEl.readOnly = true; baseEl.title = 'Base URL hardcoded to Render (change in code if needed)'; } catch(e){}
  epEl.value = localStorage.getItem('endpoint') || '/api/about/';
  bodyEl.value = localStorage.getItem('body') || '{"detail":"full"}';

  // Keep endpoint/body persisted when edited
  baseEl.addEventListener('input', () => localStorage.setItem('baseUrl', baseEl.value.trim()));
  epEl.addEventListener('input', () => localStorage.setItem('endpoint', epEl.value.trim()));
  bodyEl.addEventListener('input', () => localStorage.setItem('body', bodyEl.value));

  // Inline spinner inside Send button
  const spinnerEl = qs('#send .btn-spinner');
  function showLoader(){ if(spinnerEl){ spinnerEl.classList.remove('hidden'); spinnerEl.setAttribute('aria-hidden','false'); } sendBtn.disabled = true; }
  function hideLoader(){ if(spinnerEl){ spinnerEl.classList.add('hidden'); spinnerEl.setAttribute('aria-hidden','true'); } sendBtn.disabled = false; }
  // Toast element & helpers
  const toastEl = qs('#toast');
  const toastMsg = qs('#toastMsg');
  let toastTimer = null;
  function showToast(message, ok=true, duration=3200){
    if(!toastEl) return;
    toastEl.classList.remove('ok','bad');
    toastEl.classList.add(ok? 'ok' : 'bad');
    if(toastMsg) toastMsg.textContent = message;
    toastEl.classList.add('show');
    toastEl.setAttribute('aria-hidden','false');
    if(toastTimer) clearTimeout(toastTimer);
    toastTimer = setTimeout(()=>{ toastEl.classList.remove('show'); toastEl.setAttribute('aria-hidden','true'); toastTimer = null; }, duration);
  }
  // allow click to dismiss
  if(toastEl) toastEl.addEventListener('click', ()=>{ if(toastTimer) clearTimeout(toastTimer); toastEl.classList.remove('show'); toastEl.setAttribute('aria-hidden','true'); toastTimer = null; });

    function setStatus(text, ok=true){
      status.textContent = text;
      status.style.color = ok ? 'var(--ok)' : 'var(--bad)';
    }

    function print(msg){
      out.innerHTML = msg;
      out.scrollTop = out.scrollHeight;
    }

    function pretty(obj){
      try { return JSON.stringify(obj, null, 2); }
      catch { return String(obj); }
    }

    function logBlock(title, content, cls=''){
      return `<div style="margin-bottom:12px"><div class="subtle" style="margin-bottom:6px">${title}</div><pre class="${cls}">${content.replace(/[&<>"]/g, m=>({"&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;"}[m]))}</pre></div>`;
    }

    function addHistory(entry){
      const items = JSON.parse(localStorage.getItem('history')||'[]');
      items.unshift(entry);
      const trimmed = items.slice(0,8);
      localStorage.setItem('history', JSON.stringify(trimmed));
      renderHistory();
    }

    function renderHistory(){
      const items = JSON.parse(localStorage.getItem('history')||'[]');
      hist.innerHTML = '';
      items.forEach(({ep, body})=>{
        const pill = document.createElement('div');
        pill.className = 'pill';
        pill.textContent = `POST ${ep}`;
        pill.title = body;
        pill.addEventListener('click',()=>{epEl.value=ep; bodyEl.value=body;});
        hist.appendChild(pill);
      })
    }
    renderHistory();

    function buildUrl(){
      const base = (baseEl.value || '').replace(/\/$/,'');
      const ep = (epEl.value || '').startsWith('/') ? epEl.value : '/' + epEl.value;
      return base + ep;
    }

    async function send(){
      const url = buildUrl();
      if(!/^https?:\/\//.test(url)){
        setStatus('invalid base url', false);
        print(logBlock('Error', 'Please set a valid Base URL like https://your-backend.onrender.com', 'bad'));
        showToast('Invalid Base URL', false);
        return;
      }
      showLoader();
      setStatus('sending…');
      let data=null;
      const raw = bodyEl.value.trim();
      if(raw){
        try { data = JSON.parse(raw); }
        catch(e){
          hideLoader();
          setStatus('bad json', false);
          print(logBlock('JSON Parse Error', String(e), 'bad'));
          showToast('Bad JSON — check request body', false);
          return;
        }
      }
      const reqInfo = { method:'POST', headers:{'Content-Type':'application/json'}, body: data? JSON.stringify(data): '{}' };
      const started = Date.now();
      try{
        const res = await fetch(url, reqInfo);
        const ms = Date.now() - started;
        const text = await res.text();
        let parsed; let asJson = false;
        try { parsed = JSON.parse(text); asJson = true; } catch { parsed = text; }
        const head = `${res.status} ${res.statusText} • ${ms}ms`;
  setStatus(res.ok? 'ok' : `error ${res.status}`, res.ok);
  showToast(head, res.ok);
        const reqPreview = pretty(data ?? {});
        const resPreview = asJson ? pretty(parsed) : parsed;
        print(
          logBlock('Request', `POST ${url}\n\n${reqPreview}`) +
          logBlock('Response', resPreview, res.ok? 'ok':'bad')
        );
        addHistory({ep: epEl.value, body: bodyEl.value});
      }catch(err){
        setStatus('network error', false);
        print(logBlock('Network Error', String(err), 'bad'));
        showToast('Network error', false);
      }finally{
        hideLoader();
      }
    }

    sendBtn.addEventListener('click', send);
    clearBtn.addEventListener('click', ()=>{out.textContent=''; setStatus('idle'); showToast('Console cleared', true);});
    curlBtn.addEventListener('click', ()=>{
      const url = buildUrl();
      const body = bodyEl.value.trim() || '{}';
      const cmd = `curl -X POST ${url} -H "Content-Type: application/json" -d '${body.replace(/'/g,"'\\''")}'`;
      navigator.clipboard.writeText(cmd);
      setStatus('copied curl');
      showToast('Copied cURL', true);
    });

    document.addEventListener('keydown', (e)=>{
      if(e.key==='Enter' && (document.activeElement===epEl || document.activeElement===bodyEl)){
        e.preventDefault(); send();
      }
      if(e.key.toLowerCase()==='k' && (e.ctrlKey || e.metaKey)){
        e.preventDefault(); epEl.focus(); epEl.select();
      }
    });

    // Suggestions modal (super minimal)
    qs('#suggest').addEventListener('click', ()=>{
      const list = EXAMPLE_CMDS.map(s=>`• ${s}`).join('\n');
      alert('Available endpoints (example):\n\n' + list + '\n\nNote: The backend only accepts POST.');
    });

    // Click-to-fill examples
    document.querySelectorAll('.cmd').forEach(el=>{
      el.addEventListener('click', ()=>{ epEl.value = el.textContent; });
    });

    // If you want a default demo base URL in dev, you can set it here.
    // baseEl.value ||= 'https://your-backend.onrender.com';
  </script>
</body>
</html>